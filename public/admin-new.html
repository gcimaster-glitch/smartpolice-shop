<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>管理画面 | SmartPolice</title>
  <link rel="stylesheet" href="/css/admin.css">
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
</head>
<body>
  <!-- サイドバー -->
  <aside class="sidebar">
    <div class="sidebar-header">
      <img src="/images/logo.png" alt="SmartPolice" class="sidebar-logo">
      <h1 class="sidebar-title">管理画面</h1>
    </div>

    <nav class="sidebar-nav">
      <a href="#dashboard" class="nav-item active" data-page="dashboard">
        <i class="fas fa-chart-line"></i>
        <span>ダッシュボード</span>
      </a>
      <a href="#orders" class="nav-item" data-page="orders">
        <i class="fas fa-shopping-cart"></i>
        <span>注文管理</span>
      </a>
      <a href="#products" class="nav-item" data-page="products">
        <i class="fas fa-box"></i>
        <span>商品管理</span>
      </a>
      <a href="#services" class="nav-item" data-page="services">
        <i class="fas fa-concierge-bell"></i>
        <span>サービス申込み</span>
      </a>
      <a href="#users" class="nav-item" data-page="users">
        <i class="fas fa-users"></i>
        <span>ユーザー管理</span>
      </a>
    </nav>

    <div class="sidebar-footer">
      <div class="admin-profile">
        <div class="admin-avatar">A</div>
        <div class="admin-info">
          <div class="admin-name" id="admin-name">管理者</div>
          <div class="admin-email" id="admin-email"></div>
        </div>
      </div>
      <button class="btn-logout" onclick="logout()">
        <i class="fas fa-sign-out-alt"></i>
        <span>ログアウト</span>
      </button>
    </div>
  </aside>

  <!-- メインコンテンツ -->
  <main class="main-content">
    <!-- ダッシュボードページ -->
    <div id="page-dashboard" class="page active">
      <div class="page-header">
        <h1 class="page-title">ダッシュボード</h1>
        <p class="page-subtitle">ビジネスの全体像を一目で把握</p>
      </div>

      <!-- KPIカード -->
      <div class="kpi-grid">
        <div class="kpi-card">
          <div class="kpi-icon" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);">
            <i class="fas fa-yen-sign"></i>
          </div>
          <div class="kpi-content">
            <div class="kpi-label">今日の売上</div>
            <div class="kpi-value" id="today-sales">¥0</div>
          </div>
        </div>

        <div class="kpi-card">
          <div class="kpi-icon" style="background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);">
            <i class="fas fa-chart-line"></i>
          </div>
          <div class="kpi-content">
            <div class="kpi-label">今月の売上</div>
            <div class="kpi-value" id="month-sales">¥0</div>
            <div class="kpi-growth" id="sales-growth">+0%</div>
          </div>
        </div>

        <div class="kpi-card">
          <div class="kpi-icon" style="background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);">
            <i class="fas fa-shopping-bag"></i>
          </div>
          <div class="kpi-content">
            <div class="kpi-label">今月の注文</div>
            <div class="kpi-value" id="month-orders">0</div>
            <div class="kpi-growth" id="orders-growth">+0%</div>
          </div>
        </div>

        <div class="kpi-card">
          <div class="kpi-icon" style="background: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%);">
            <i class="fas fa-users"></i>
          </div>
          <div class="kpi-content">
            <div class="kpi-label">総ユーザー数</div>
            <div class="kpi-value" id="total-users">0</div>
            <div class="kpi-growth" id="users-growth">+0%</div>
          </div>
        </div>
      </div>

      <!-- グラフエリア -->
      <div class="charts-grid">
        <div class="chart-card">
          <div class="chart-header">
            <h3 class="chart-title">売上推移（過去7日間）</h3>
          </div>
          <div class="chart-body">
            <canvas id="salesTrendChart"></canvas>
          </div>
        </div>

        <div class="chart-card">
          <div class="chart-header">
            <h3 class="chart-title">カテゴリ別売上</h3>
          </div>
          <div class="chart-body">
            <canvas id="categoryChart"></canvas>
          </div>
        </div>

        <div class="chart-card">
          <div class="chart-header">
            <h3 class="chart-title">注文ステータス分布</h3>
          </div>
          <div class="chart-body">
            <canvas id="statusChart"></canvas>
          </div>
        </div>

        <div class="chart-card">
          <div class="chart-header">
            <h3 class="chart-title">人気商品ランキング</h3>
          </div>
          <div class="chart-body">
            <div id="popular-products-list"></div>
          </div>
        </div>
      </div>

      <!-- アクティビティエリア -->
      <div class="activity-grid">
        <div class="activity-card">
          <div class="activity-header">
            <h3 class="activity-title">最近の注文</h3>
            <a href="#orders" class="activity-link">すべて表示 →</a>
          </div>
          <div class="activity-body" id="recent-orders-list"></div>
        </div>

        <div class="activity-card">
          <div class="activity-header">
            <h3 class="activity-title">新規ユーザー</h3>
            <a href="#users" class="activity-link">すべて表示 →</a>
          </div>
          <div class="activity-body" id="recent-users-list"></div>
        </div>
      </div>
    </div>

    <!-- 注文管理ページ -->
    <div id="page-orders" class="page">
      <div class="page-header">
        <h1 class="page-title">注文管理</h1>
        <p class="page-subtitle">すべての注文を管理</p>
      </div>

      <!-- 検索・フィルター -->
      <div class="filter-bar">
        <div class="search-box">
          <i class="fas fa-search"></i>
          <input type="text" id="order-search" placeholder="注文番号、顧客名で検索...">
        </div>
        <select id="order-status-filter" class="filter-select">
          <option value="">すべてのステータス</option>
          <option value="pending">保留中</option>
          <option value="paid">支払済</option>
          <option value="processing">処理中</option>
          <option value="shipped">発送済</option>
          <option value="delivered">配達完了</option>
          <option value="cancelled">キャンセル</option>
        </select>
        <button class="btn-primary" onclick="exportOrders()">
          <i class="fas fa-download"></i>
          エクスポート
        </button>
      </div>

      <div class="table-container">
        <table class="data-table">
          <thead>
            <tr>
              <th><input type="checkbox" id="select-all-orders"></th>
              <th>注文番号</th>
              <th>顧客名</th>
              <th>金額</th>
              <th>配送日</th>
              <th>ステータス</th>
              <th>注文日</th>
              <th>操作</th>
            </tr>
          </thead>
          <tbody id="orders-table-body">
            <tr>
              <td colspan="8" class="loading-row">
                <div class="spinner"></div>
                読み込み中...
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>

    <!-- 商品管理ページ -->
    <div id="page-products" class="page">
      <div class="page-header">
        <h1 class="page-title">商品管理</h1>
        <p class="page-subtitle">商品の登録・編集・削除</p>
      </div>

      <div class="filter-bar">
        <div class="search-box">
          <i class="fas fa-search"></i>
          <input type="text" id="product-search" placeholder="商品名、カテゴリで検索...">
        </div>
        <button class="btn-primary" onclick="showAddProductModal()">
          <i class="fas fa-plus"></i>
          商品を追加
        </button>
      </div>

      <div class="table-container">
        <table class="data-table">
          <thead>
            <tr>
              <th><input type="checkbox" id="select-all-products"></th>
              <th>商品名</th>
              <th>カテゴリ</th>
              <th>価格</th>
              <th>在庫</th>
              <th>登録日</th>
              <th>操作</th>
            </tr>
          </thead>
          <tbody id="products-table-body">
            <tr>
              <td colspan="7" class="loading-row">
                <div class="spinner"></div>
                読み込み中...
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>

    <!-- サービス申込み管理ページ -->
    <div id="page-services" class="page">
      <div class="page-header">
        <h1 class="page-title">サービス申込み管理</h1>
        <p class="page-subtitle">サービス申込みを管理</p>
      </div>

      <div class="filter-bar">
        <div class="search-box">
          <i class="fas fa-search"></i>
          <input type="text" id="service-search" placeholder="サービス名、申込者で検索...">
        </div>
        <select id="service-status-filter" class="filter-select">
          <option value="">すべてのステータス</option>
          <option value="pending">保留中</option>
          <option value="reviewing">審査中</option>
          <option value="approved">承認済</option>
          <option value="rejected">却下</option>
        </select>
      </div>

      <div class="table-container">
        <table class="data-table">
          <thead>
            <tr>
              <th>申込ID</th>
              <th>サービス名</th>
              <th>申込者</th>
              <th>メール</th>
              <th>申込日</th>
              <th>ステータス</th>
              <th>操作</th>
            </tr>
          </thead>
          <tbody id="services-table-body">
            <tr>
              <td colspan="7" class="loading-row">
                <div class="spinner"></div>
                読み込み中...
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>

    <!-- ユーザー管理ページ -->
    <div id="page-users" class="page">
      <div class="page-header">
        <h1 class="page-title">ユーザー管理</h1>
        <p class="page-subtitle">登録ユーザーの管理</p>
      </div>

      <div class="filter-bar">
        <div class="search-box">
          <i class="fas fa-search"></i>
          <input type="text" id="user-search" placeholder="名前、メールアドレスで検索...">
        </div>
      </div>

      <div class="table-container">
        <table class="data-table">
          <thead>
            <tr>
              <th>ID</th>
              <th>名前</th>
              <th>メールアドレス</th>
              <th>登録日</th>
              <th>最終ログイン</th>
              <th>ステータス</th>
            </tr>
          </thead>
          <tbody id="users-table-body">
            <tr>
              <td colspan="6" class="loading-row">
                <div class="spinner"></div>
                読み込み中...
              </td>
            </tr>
          </tbody>
        </table>
      </div>
    </div>
  </main>

  <!-- ログイン画面 -->
  <div id="login-screen" class="login-screen">
    <div class="login-container">
      <div class="login-card">
        <div class="login-header">
          <img src="/images/logo.png" alt="SmartPolice" class="login-logo">
          <h2 class="login-title">管理者ログイン</h2>
          <p class="login-subtitle">SmartPolice 管理画面へようこそ</p>
        </div>
        <form class="login-form" onsubmit="handleLogin(event)">
          <div class="form-group">
            <label>メールアドレス</label>
            <input type="email" id="login-email" required placeholder="admin@smartpolice.net">
          </div>
          <div class="form-group">
            <label>パスワード</label>
            <input type="password" id="login-password" required placeholder="••••••••">
          </div>
          <button type="submit" class="btn-login">
            ログイン
          </button>
        </form>
      </div>
    </div>
  </div>

  <script src="/js/toast.js"></script>
  <script src="/js/admin-dashboard.js"></script>
  <script src="/js/admin-management.js"></script>
  <script src="/js/admin.js"></script>
</body>
</html>
